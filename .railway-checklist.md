# Railway Deploy Checklist

Use este checklist antes de fazer deploy para garantir que tudo está configurado corretamente.

## Pré-Deploy

### Configuração Local
- [ ] Projeto roda localmente sem erros (`pnpm dev`)
- [ ] Build funciona sem erros (`pnpm build`)
- [ ] Todas as variáveis do `.env.example` estão configuradas no `.env`
- [ ] Types do Directus gerados (`pnpm generate:types`)
- [ ] ESLint sem erros (`pnpm lint`)

### Railway Setup
- [ ] Railway CLI instalado (`railway --version`)
- [ ] Logado no Railway (`railway whoami`)
- [ ] Vinculado ao projeto 'events-flow' (`railway status`)

### Variáveis de Ambiente Railway
- [ ] `NEXT_PUBLIC_DIRECTUS_URL` configurada
- [ ] `DIRECTUS_PUBLIC_TOKEN` configurada
- [ ] `DIRECTUS_FORM_TOKEN` configurada
- [ ] `DIRECTUS_ADMIN_TOKEN` configurada
- [ ] `NEXT_PUBLIC_SITE_URL` configurada
- [ ] `DRAFT_MODE_SECRET` configurada (gere um aleatório se necessário)
- [ ] `NEXT_PUBLIC_ENABLE_VISUAL_EDITING` configurada

### Stripe (se aplicável)
- [ ] `STRIPE_SECRET_KEY` configurada
- [ ] `STRIPE_PUBLISHABLE_KEY` configurada
- [ ] Webhooks configurados no Stripe Dashboard

### OpenAI (se aplicável)
- [ ] `OPENAI_API_KEY` configurada

## Durante Deploy

- [ ] Commit das mudanças no Git
- [ ] Deploy iniciado (`railway up` ou `pnpm railway:deploy`)
- [ ] Build completou sem erros
- [ ] Serviço está rodando (`railway status`)

## Pós-Deploy

### Verificações Básicas
- [ ] Site abre sem erros (`railway open`)
- [ ] Home page carrega corretamente
- [ ] Imagens do Directus carregam
- [ ] Navegação funciona

### Configuração Directus
- [ ] CORS configurado para aceitar a URL do Railway
  - Directus: `CORS_ENABLED=true`
  - Directus: `CORS_ORIGIN` inclui URL do frontend
- [ ] Preview mode funciona (teste via Directus)
- [ ] Live Preview funciona (se habilitado)

### Integração Stripe
- [ ] Webhooks configurados no Stripe apontam para Railway
  - `https://seu-app.railway.app/api/stripe/webhook`
  - `https://seu-app.railway.app/api/organizer/stripe/onboarding`
- [ ] Testar criação de pagamento
- [ ] Verificar logs do webhook (`pnpm railway:logs`)

### Performance & Monitoramento
- [ ] Tempo de carregamento aceitável (< 3s)
- [ ] Logs sem erros críticos
- [ ] Métricas de CPU/RAM normais no Railway Dashboard

### SEO & Meta Tags
- [ ] Meta tags carregando corretamente (inspecione source)
- [ ] Open Graph tags presentes
- [ ] Sitemap acessível (se configurado)

## Comandos de Verificação

```bash
# Ver status
railway status

# Ver logs
railway logs -f

# Ver variáveis
railway variables

# Abrir no navegador
railway open

# Ver métricas
# Acesse: https://railway.app/project/events-flow
```

## Rollback (se necessário)

```bash
# Ver deploys anteriores
railway deployments

# Fazer rollback para deploy anterior
railway rollback <deployment-id>
```

## Suporte

- Railway Docs: https://docs.railway.app
- Railway Discord: https://discord.gg/railway
- Logs detalhados: `railway logs -f`
